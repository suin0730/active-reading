---
tags: [Book/Effective Java/Ch8 - 메서드]
title: '[Item 49] 매개변수가 유효한지 검사하라'
created: '2022-06-13T14:03:21.629Z'
modified: '2022-06-14T01:09:34.475Z'
---

# [Item 49] 매개변수가 유효한지 검사하라

## 매개변수 제약 문서화

메서드와 생성자의 입력 매개변수는 대부분 특정 조건을 만족해야 한다. (인덱스 음수 불가, 객체 참조 notnull 등)

## 매개변수 검사가 없을 때 발생할 수 있는 문제

메서드 몸체가 실행되기 전에 매개변수를 확인하면 잘못된 값을 바로 확인해 예외를 던질 수 있다. 반면 매개변수 검사를 수행하지 않으면 아래와 같은 문제들이 잠재적으로 발생할 수 있다.

1) 메서드가 수행되는 중간에 모호한 예외를 던지며 실패하는 경우
2) 메서드가 잘 수행되지만 잘못된 결과를 반환하는 경우
3) 메서드가 문제없이 수행됐지만, 특정 객체를 이상한 상태로 만드는 경우

특히 3번 문제는 객체를 이상한 상태로 만듦으로써 미래 알 수 없는 시점에 해당 메서드와는 관련 없는 오류를 내고, 실패 원자성을 어기는 결과를 낳는다.

## 예외 문서화 방법

public, protected 메서드는 공개 API이므로 매개변수 제약과 이를 어겼을 때 던지는 예외를 함께 문서화해 클라이언트가 제약을 지킬 가능성을 높여야 한다. `@throws` 자바독 태그를 활용하면 되는데, 아래 예시를 보면 문서화는 안되어있지만 m.signum() 호출 시에 `NullPointerException`을 던지게 된다는 것을 확인할 수 있다. **이는 이 설명을 mod 메서드가 아닌 BigInteger 클래스 수준에서 기술했기 때문이다. 클래스 수준 주석은 그 클래스의 모든 public 메서드에 적용되므로 각 메서드에 일일이 기술하는 것보다 훨씬 깔끔한 방법이다.**

```java
...
@throws ArithmeticException m이 0보다 작거나 같으면 발생한다.
public BigInteger mod(BigInteger m) {
  if(m.signum() <= 0)
}
...
```

## 매개변수 검사 방법

### 유효성 검사 메서드
- requiredNonNull: null 검사를 수동으로 하지 않도록, 명확하고(explicit) 빠르게(fail-fast) 예외를 던져주는 메서드
- checkFromIndexSize: fromIndex(포함)에서 fromIndex + 크기(제외)까지의 하위 범위가 0(포함)에서 길이(제외) 범위 범위 내에 있는지 확인하는 메서드
- checkFromToIndex: fromIndex(포함)에서 toIndex(제외)까지의 하위 범위가 0(포함)에서 길이(제외)까지 범위의 범위 내에 있는지 확인하는 메서드
- checkIndex: 인덱스가 0(포함)에서 길이(제외) 범위의 범위 내에 있는지 확인하는 메서드

### 공개되지 않은 메서드인 경우

패키지 제작자가 메서드가 호출되는 상황을 통제할 수 있다면 `assert`를 사용해 매개변수 유효성을 검증하면 된다. 단언문은 일반적인 유효성 검사와 달리 1)실패하면 AssertionError를 던지고 2)런타임에 아무 효과나 성능 저하가 없다.

### 특히 주의해야 하는 상황

**메서드가 직접 사용하지 않으나 나중에 쓰기 위해 저장하는 매개변수는 클래스 불변식을 어기는 객체가 만들어지지 않도록 하기 위해 특히 더 신경써서 검사해야 한다.**

## 매개변수를 검사하지 않는 예외 상황

메서드 호출 전 매개변수 유효성을 검사하지 않아도 되는 상황이 일부 있다. 1)유효성 검사 비용이 지나치게 높거나 2)실용적이지 않을 때, 3)계산 과정에서 암묵적으로 검사가 수행될 때이다. 예를 들어 상호 비교 가능해야하는 객체 리스트를 정렬할 때 비교할 수 없는 타입 객체가 들어있다면 `ClassCastException`을 던지겠지만 이 예외를 던지기 위해 상호 비교 가능한지를 검사해봤자 얻을 수 있는 이득이 없다.

> 메서드는 최대한 범용적으로 설계해야 한다. 메서드가 건네받은 값으로 정상 수행을 할 수 있다면 매개변수 제약을 적을 수록 좋다는 것을 기억해야 한다.


